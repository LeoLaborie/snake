from tensorflow import keras
from keras.models import Sequential
from keras.layers import Dense
import numpy as np
import random


model = Sequential()
model.add(keras.Input(shape=(10,)))
model.add(Dense(32, activation='relu'))
model.add(Dense(32, activation='relu'))
model.add(Dense(32, activation='relu'))
model.add(Dense(4, activation="softmax"))
model.compile(loss = 'mean_squared_error',  optimizer = 'sgd', metrics = [keras.metrics.categorical_accuracy])

model.load_weights("models/snake_model_weights0.h5")

# [0,0,0,1,0,0,0,0,0,0] [1/3,1/3,1/3,0]
# [0,0,1,0,0,0,0,0,0,0] [1/3,1/3,0,1/3]
# [0,0,1,1,0,0,0,0,0,0] [1/2,1/2,0,0]
# [0,1,0,0,0,0,0,0,0,0] [1/3,0,1/3,1/3]
# [0,1,0,1,0,0,0,0,0,0] [1/2,0,1/2,0]
# [0,1,1,0,0,0,0,0,0,0] [1/2,0,0,1/2]
# [0,1,1,1,0,0,0,0,0,0] [1,0,0,0]
# [1,0,0,0,0,0,0,0,0,0] [0,1/3,1/3,1/3]
# [1,0,0,1,0,0,0,0,0,0] [0,1/2,1/2,0]
# [1,0,1,0,0,0,0,0,0,0] [0,1/2,0,1/2]
# [1,0,1,1,0,0,0,0,0,0] [0,1,0,0]
# [1,1,0,0,0,0,0,0,0,0] [0,0,1/2,1/2]
# [1,1,0,1,0,0,0,0,0,0] [0,0,1,0]
# [1,1,1,0,0,0,0,0,0,0] [0,0,0,1]

X = [
    [0,0,0,1,0,0,0,0,0,0],
    [0,0,1,0,0,0,0,0,0,0],
    [0,0,1,1,0,0,0,0,0,0],
    [0,1,0,0,0,0,0,0,0,0],
    [0,1,0,1,0,0,0,0,0,0],
    [0,1,1,0,0,0,0,0,0,0],
    [0,1,1,1,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0,0,0],
    [1,0,0,1,0,0,0,0,0,0],
    [1,0,1,0,0,0,0,0,0,0],
    [1,0,1,1,0,0,0,0,0,0],
    [1,1,0,0,0,0,0,0,0,0],
    [1,1,0,1,0,0,0,0,0,0],
    [1,1,1,0,0,0,0,0,0,0],
]

Y = [
    [1/3,1/3,1/3,0],
    [1/3,1/3,0,1/3],
    [1/2,1/2,0,0],
    [1/3,0,1/3,1/3],
    [1/2,0,1/2,0],
    [1/2,0,0,1/2],
    [1,0,0,0],
    [0,1/3,1/3,1/3],
    [0,1/2,1/2,0],
    [0,1/2,0,1/2],
    [0,1,0,0],
    [0,0,1/2,1/2],
    [0,0,1,0],
    [0,0,0,1],
]

model.fit(np.array(X), np.array(Y), batch_size=1, epochs=1000)

model.save_weights("models/snake_model_weights0.h5")